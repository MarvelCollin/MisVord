FROM node:20-alpine

# Install curl for healthchecks
RUN apk add --no-cache curl

# Create app directory
WORKDIR /usr/src/app

# Install app dependencies
COPY package*.json ./

# Install dependencies
RUN npm install

# Bundle app source
COPY . .

# Set environment variables with defaults
ENV PORT=1002
ENV SECURE_PORT=1443
ENV NODE_ENV=production

# Expose ports
EXPOSE 1002
EXPOSE 1443

# Start socket server
CMD [ "node", "socket-server.js" ]